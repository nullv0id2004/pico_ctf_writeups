# Local Authority
## Description
Can you get the flag? Go to this [website](http://saturn.picoctf.net:49386/) and see what you can discover.
## Type: Web Exploitation
## Solving
1) First I opened the website and inspected it.
2) I was not able to find anything useful.
3) I entered a random username and password to see where it redirects.
4) It redirects to a page with message Log in Failed.
5) I inspected that page and observed the sources.
6) So i got a `php file` and a `js file`. I explained the code's function in comments
```php
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="style.css">
    <title>Login Page</title>
  </head>
  <body>
    <script src="secure.js"></script>
    
    <p id='msg'></p>
    
    <form hidden action="admin.php" method="post" id="hiddenAdminForm">
      <input type="text" name="hash" required id="adminFormHash">
    </form>
    
    <script type="text/javascript">

        // function filter checks if the password is valid or not by checking ascii of each chararter in string

      function filter(string) {
        filterPassed = true;
        for (let i =0; i < string.length; i++){
          cc = string.charCodeAt(i);
          
          if ( (cc >= 48 && cc <= 57) ||
               (cc >= 65 && cc <= 90) ||
               (cc >= 97 && cc <= 122) )
          {
            filterPassed = true;     
          }
          else
          {
            return false;
          }
        }
        
        return true;
      }
    
      window.username = "manas";
      window.password = "manas";
      
      usernameFilterPassed = filter(window.username);
      passwordFilterPassed = filter(window.password);

      // now it checks if the username and password is correct of not by function checkPassword.
      
      if ( usernameFilterPassed && passwordFilterPassed ) {
      
        loggedIn = checkPassword(window.username, window.password);
        
        if(loggedIn)
        {
          document.getElementById('msg').innerHTML = "Log In Successful";
          document.getElementById('adminFormHash').value = "2196812e91c29df34f5e217cfd639881";
          document.getElementById('hiddenAdminForm').submit();
        }
        else
        {
          document.getElementById('msg').innerHTML = "Log In Failed";
        }
      }
      else {
        document.getElementById('msg').innerHTML = "Illegal character in username or password."
      }
    </script>
    
  </body>
</html>
```
7) The js file had the function for checkPassword
```js
// Its is a very straightforward function which returns true if the condition satisfies
function checkPassword(username, password)
{
  if( username === 'admin' && password === 'strongPassword098765' )
  {
    return true;
  }
  else
  {
    return false;
  }
}
```
8) On further inspecting the php file I figured out where it stores the username and password entered by user and how it checks it. So it stores the username in window.username and password in window.password and checks it using a function checkPassword which is written in `secure.js` file.
9) The js file has the function checkPassword which is very straightforward and gives the username and password of the website.
10) Now log in using username and password and it will redirect you to a page with the flag.

        Flag:picoCTF{j5_15_7r4n5p4r3n7_b0c2c9cb} 