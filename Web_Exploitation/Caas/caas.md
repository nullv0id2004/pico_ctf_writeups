# Caas
## Description
Now presenting [cowsay as a service](https://caas.mars.picoctf.net/).
## Type: Web Exploitation
## Solving
1) Visit the link
2) It tells us to make a request to the following URL to cowsay your message
https://caas.mars.picoctf.net/cowsay/{message}
3) I inspected the elements using console to find hints and nothing special was found.
4) Then i went to the [URL](https://caas.mars.picoctf.net/cowsay/manas) and wrote a message as manas
5) I inspected that website with console and again nothing special was found.
![](/Web_Exploitation/Caas/caas_resources/c1.png)
6) Now I inspected the given file index.js
7) We can Observe that it is using HTTP GET call which means it is requesting data from a specified resourse.
```js
const express = require('express');
const app = express();
const { exec } = require('child_process');

app.use(express.static('public'));

app.get('/cowsay/:message', (req, res) => {
  exec(`/usr/games/cowsay ${req.params.message}`, {timeout: 5000}, (error, stdout) => {
    if (error) return res.status(500).end();
    res.type('txt').send(stdout).end();
  });
});

app.listen(3000, () => {
  console.log('listening');
});
```
8) We can observe that it is executing from /usr/games/cowsay on the command line and requesting the parameter `message` and dumping it in the command.
9) So here we can inject another command after the message to get more information:

        Example: https://caas.mars.picoctf.net/cowsay/manas;ls  
10) It executed the command and we can see more files.
![](/Web_Exploitation/Caas/caas_resources/c2.png)
11) Now we concat `falg.txt` which is the flag that is mispelled and get the flag of this challenge.
![](/Web_Exploitation/Caas/caas_resources/c3.png)

        Flag: picoCTF{moooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0o}